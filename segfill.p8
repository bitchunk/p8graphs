pico-8 cartridge // http://www.pico-8.com
version 42
__lua__
--segfill v0.2
--@shiftalow / bitchunk

--[[
	- segfill        			-- fill segment shape.
	- @param  number x  -- x coordinates.
	- @param  number y  -- y coordinates.
	- @param  number r  -- radius.
	- @param  number c  -- fill color.
	- @param  number s  -- starting angle, 0 is the bottom, 0.5 is the top.
	- @param  number d  -- circumferential distance from start angle.
	- @description
		-- if the difference between the start angle and the end angle is 0.5 or more, it is a semicircle, and if the difference is 1 or more, it is a circle.
		-- if the start position is higher than the end position, it is replaced.
]]--
st=0
d=0.02
stoptime=nil
delaytime=0

function _update60()
end

function _draw()
cls()
local x,y,r=64,80,32
col=btn(4) and {10,11,12} or {}
local s=0

--s+=(tonum(btn(1))-tonum(btn(0)))*0.005
--s+=(tonum(btn(2))-tonum(btn(3)))*0.02
--st+=(btn(4) or btn(5)) and s or 0
--d+=(btn(4) or btn(5)) and 0 or s

stoptime=btn(5) and (stoptime or time()-delaytime) or nil
delaytime=stoptime and time()-stoptime or delaytime
local bt=time()-delaytime
st=bt/4
d=0.5+cos(bt/8)*0.5

segfill(x,y,r,9,st,d)

local en=st+d
local sx,sy,ex,ey,se=
						sin(st)*r,cos(st)*r
						,sin(en)*r,cos(en)*r
						,-1
line(sx*1.4+x,sy*1.4+y,sx+x,sy+y,8)
line(ex*1.4+x,ey*1.4+y,ex+x,ey+y,10)

end

function segfill(x,y,r,c,s,d)
	color(c)
	local e=s+mid(d,1,-1)
	if s>e then
		s,e=e,s
	end

	local sx,sy,ex,ey,se=
							sin(s)*r,cos(s)*r
							,sin(e)*r,cos(e)*r
							,-1
	if sy>ey then
		sx,sy,ex,ey,se=ex,ey,sx,sy
		,1
	end

	local sel,sr,er=(e-s),s%1\0.5,e%1\0.5

	--top-r to start-y
	local pr,u,d=er,-r+1,sy-1
	while sr do
--		color(deli(col) or c)
		if er>0 and sr<1 or sel>0.5 and er==sr then
			for u=u,d do
				local xi=(sqrt((r+u)*(r-u))+0.5)\1
				rectfill(x-xi,u+y,x+xi,u+y)
			end
		end
		--end-y to bottom-r
		u,d,er,sr,pr=ey,r,sr,pr
	end
	
	--start-y to end-y
--	color(deli(col) or c)
	local i,xr=(ex-sx)/(ey-sy),sx+x
	for u=sy,ey&0xffff do
		rectfill(x-sqrt((r+u)*(r-u))*se,u+y,xr,u+y)
		xr+=i
	end
end
-->8
--[[
update history
**v0.2**
	- remove extra judgments and variable swapping
	- remove noise at distance 0
	- distance 1 or more and 1 or less will make the result the same
**v0.1**
	- first release
]]--

__gfx__
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__label__
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000099900000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000999990000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000009999999000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000099999999900000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000999999999990000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000999999999999000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000009999999999999900000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000099999999999999990000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000999999999999999990000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000999999999999999999000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000009999999999999999999000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000099999999999999999999900000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000999999999999999999999900000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000999999999999999999999990000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000009999999999999999999999990000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000099999999999999999999999999000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000999999999999999999999999999000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000999999999999999999999999999000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000009999999999999999999999999999900000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000099999999999999999999999999999900000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000999999999999999999999999999999900000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000999999999999999999999999999999900000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000009999999999999999999999999999999900000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000099999999999999999999999999999999900000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000999999999999999999999999999999999900000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000999999999999999999999999999999999900000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000009999999999999999999999999999999999900000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000099999999999999999999999999999999999900000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000999999999999999999999999999999999999900000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000999999999999999999999999999999999999900000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000009999999999999999999999999999999999999900000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000099999999999999999999999999999999999999900000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000999999999999999999999999999999999999999900000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000999999999999999999999999999999999999999900000000000000000000000000000000
00000000000000000000000000000000000000000000000000000009999999999999999999999999999999999999999000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000099999999999999999999999999999999999999999000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000999999999999999999999999999999999999999999000000000000000000000000000000000
00000000000000000000000000000000000000000000000000009999999999999999999999999999999999999999990000000000000000000000000000000000
00000000000000000000000000000000000000000000000000009999999999999999999999999999999999999999990000000000000000000000000000000000
00000000000000000000000000000000000000000000000000099999999999999999999999999999999999999999990000000000000000000000000000000000
00000000000000000000000000000000000000000000000000999999999999999999999999999999999999999999900000000000000000000000000000000000
00000000000000000000000000000000000000000000000009999999999999999999999999999999999999999999900000000000000000000000000000000000
00000000000000000000000000000000000000000000000009999999999999999999999999999999999999999999000000000000000000000000000000000000
00000000000000000000000000000000000000000000000099999999999999999999999999999999999999999990000000000000000000000000000000000000
00000000000000000000000000000000000000000000000999999999999999999999999999999999999999999990000000000000000000000000000000000000
00000000000000000000000000000000000000000000009999999999999999999999999999999999999999999900000000000000000000000000000000000000
00000000000000000000000000000000000000000000009999999999999999999999999999999999999999999000000000000000000000000000000000000000
00000000000000000000000000000000000000000000099999999999999999999999999999999999999999990000000000000000000000000000000000000000
00000000000000000000000000000000000000000000999999999999999999999999999999999999999999900000000000000000000000000000000000000000
00000000000000000000000000000000000000000009999999999999999999999999999999999999999999000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000a999999999999999999999999999999999999999999000000000000000000000000000000000000000000
000000000000000000000000000000000000000000a0999999999999999999999999999999999999999990000000000000000000000000000000000000000000
00000000000000000000000000000000000000000a00009999999999999999999999999999999999999000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000a000000999999999999999999999999999999999990000000000000000000000000000000000000000000000
000000000000000000000000000000000000000a0000000009999999999999999999999999999999000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000a0000000000099999999999999999999999999900000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000a00000000000000099999999999999999999900000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000a000000000000000000099999999999999900000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000

